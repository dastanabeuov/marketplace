<%= turbo_frame_tag "cart_button_#{product.id}" do %>
  <% quantity = cart && cart[product.id.to_s].to_i %>
  <% in_cart = quantity > 0 %>

  <%= button_to add_item_cart_path(product_id: product.id),
      method: :post,
      data: { turbo_frame: "cart_button_#{product.id}" },
      class: "btn btn-sm d-flex align-items-center gap-1 #{in_cart ? 'btn-success' : 'btn-outline-secondary'}",
      title: in_cart ? "Товар в корзине (#{quantity})" : "#{I18n.t('.add_to_cart')}" do %>

      <i class="bi <%= in_cart ? 'bi-cart-check' : 'bi-cart-plus' %>"></i>
      <% if in_cart %>
        <span><%= quantity %></span>
      <% end %>
  <% end %>
<% end %>
