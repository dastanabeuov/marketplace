<%= turbo_frame_tag "cart_contents" do %>
  <% if cart.any? %>
    <% colors = %w[primary secondary success danger warning info light dark] %>
    <ul class="list-group mt-5">
      <% cart.each_with_index do |(product_id, quantity), index| %>
        <% product = Product.find_by(id: product_id) %>
        <% next unless product %>
        <% color_class = colors[index % colors.length] %>

        <li id="cart_item_<%= product.id %>" class="list-group-item list-group-item-<%= color_class %> d-flex justify-content-between align-items-center">
          <div><%= product.name %></div>
          <div class="d-flex align-items-center gap-2">
            <%= form_with url: update_quantity_cart_path, method: :patch, data: { turbo_stream: true }, class: "d-flex align-items-center gap-2", local: false do %>
              <%= hidden_field_tag :product_id, product.id %>
              <%= number_field_tag :quantity, quantity, min: 1,
                  class: "form-control form-control-sm",
                  style: "width: 70px;",
                  onchange: "this.form.requestSubmit()" %>
            <% end %>

            <%= link_to I18n.t('destroy'), remove_item_cart_path(product_id: product.id),
                data: { turbo_method: :delete, turbo_stream: true },
                class: "btn btn-danger btn-sm" %>
          </div>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p class="mt-5 text-center bg-warning-subtle"><%= I18n.t('empty_cart') %></p>
  <% end %>
<% end %>
<div class="d-flex justify-content-between mt-5">
  <%= button_to "#{I18n.t('place_an_order')}", orders_path, method: :post, class: "btn btn-success", data: { disable_with: I18n.t('please_wait') } %>
  <%= button_to "#{I18n.t('clear_cart')}", clear_cart_path, method: :delete, class: "btn btn-outline-secondary" %>
</div>
